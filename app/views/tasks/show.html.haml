- model_class = Task

.page-header
  %h1=t '.title', :default => model_class.model_name.human

.form-actions
  = link_to t('.back', :default => t("helpers.links.back")), tasks_path, :class => 'btn'
  = link_to t('.edit', :default => t("helpers.links.edit")), edit_task_path(@task), :class => 'btn'
  = link_to t('.destroy', :default => t("helpers.links.destroy")), task_path(@task), :method => "delete", :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) }, :class => 'btn btn-danger'

%p
  %strong= model_class.human_attribute_name(:name) + ':'
  %br
  = @task.name
%p
  %strong= model_class.human_attribute_name(:state) + ':'
  %br
  = @task.state
%p
  %strong= 'Owner:'
  %br
  = @task.user ? @task.user.email : '<none>'

- @task.state_events.each do |e|
  = link_to e.capitalize, state_task_path(@task, event: e), :class => "btn btn-primary", :method => :put

%h4 Comments
%table.table.table-striped.table-bordered.table-condensed
  - @task.comments.each do |c|
    %tr
      %td
        .float-left
          %em
            = c.created_at.strftime("%d %b %H:%M")
            \&nbsp;by&nbsp
            = c.user.email
        = c.body

= form_for @comment do |f|
  = f.hidden_field :user_id, value: current_user.id
  = f.hidden_field :task_id, value: @task.id
  = f.text_area :body, rows: '3'
  %br
  = f.submit 'Add', class: 'btn'
